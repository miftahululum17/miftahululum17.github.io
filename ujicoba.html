<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Reward Modern</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <script src='//libtl.com/sdk.js' data-zone='9865183' data-sdk='show_9865183'></script>
    
    <style>
        .glass-morphism {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
    </style>
</head>
<body class="text-white font-sans pb-20">

    <div id="auth-section" class="container mx-auto px-4 py-10 max-w-md">
        <div class="glass-morphism rounded-3xl p-8 shadow-2xl animate__animated animate__fadeInDown">
            <h2 id="auth-title" class="text-3xl font-bold text-center mb-6">Masuk</h2>
            
            <div id="auth-form">
                <input type="text" id="username" placeholder="Username" class="w-full p-4 mb-4 rounded-xl bg-white/20 border-none text-white placeholder-white/60 focus:ring-2 focus:ring-yellow-400 outline-none">
                
                <div id="login-buttons">
                    <button onclick="handleLogin()" class="w-full bg-yellow-400 hover:bg-yellow-500 text-purple-900 font-bold py-4 rounded-xl transition duration-300 mb-4 shadow-lg">Login</button>
                    <p class="text-center text-sm">Belum punya akun? <span onclick="toggleAuth(false)" class="underline cursor-pointer">Daftar User</span></p>
                </div>

                <div id="register-buttons" class="hidden">
                    <button onclick="handleRegister()" class="w-full bg-green-400 hover:bg-green-500 text-white font-bold py-4 rounded-xl transition duration-300 mb-4 shadow-lg">Daftar Sekarang</button>
                    <p class="text-center text-sm">Sudah punya akun? <span onclick="toggleAuth(true)" class="underline cursor-pointer">Login</span></p>
                </div>
            </div>
        </div>
    </div>

    <div id="main-app" class="hidden container mx-auto px-4 py-8 max-w-md animate__animated animate__fadeIn">
        <div class="flex justify-between items-center mb-6 glass-morphism p-4 rounded-2xl">
            <div>
                <p class="text-xs opacity-70">Username</p>
                <p id="display-user" class="font-bold text-lg text-yellow-300"></p>
            </div>
            <div class="text-right">
                <p class="text-xs opacity-70">Total Poin</p>
                <p id="display-points" class="font-bold text-2xl text-green-400">0</p>
            </div>
        </div>

        <div class="glass-morphism rounded-3xl p-8 shadow-2xl text-center relative overflow-hidden">
            <div id="notif" class="hidden absolute top-0 left-0 w-full p-2 text-sm font-bold animate__animated"></div>
            
            <h3 class="text-xl mb-4">Berapa hasil dari:</h3>
            <div id="question" class="text-5xl font-black mb-8 text-yellow-300">0 + 0</div>

            <div id="options" class="grid grid-cols-2 gap-4 mb-8">
                </div>

            <div class="space-y-4">
                <button onclick="generateQuiz()" class="w-full bg-blue-500 hover:bg-blue-600 py-3 rounded-xl font-semibold transition">Ganti Soal</button>
                <button id="btn-ads" disabled onclick="showMonetagAd()" class="w-full bg-gray-500 text-white py-4 rounded-xl font-bold shadow-lg cursor-not-allowed transition duration-500">
                    üéÅ Lihat Iklan Reward (+5 Poin)
                </button>
            </div>
        </div>

        <button onclick="logout()" class="mt-8 w-full text-red-300 font-semibold underline">Logout</button>
    </div>

    <nav class="fixed bottom-0 left-0 right-0 bg-white/10 backdrop-blur-md border-t border-white/20 p-4 flex justify-around items-center z-50">
        <div class="text-center flex flex-col items-center opacity-50 cursor-pointer" onclick="showSection('quiz')">
            <span class="text-xl">üéÆ</span>
            <span class="text-[10px]">Quiz</span>
        </div>
        <div class="text-center flex flex-col items-center opacity-50 cursor-pointer" onclick="alert('Menu Poin Aktif')">
            <span class="text-xl">üí∞</span>
            <span class="text-[10px]">Poin</span>
        </div>
        <div class="text-center flex flex-col items-center opacity-50 cursor-pointer" onclick="alert('Halaman Admin (Segera)')">
            <span class="text-xl">üõ°Ô∏è</span>
            <span class="text-[10px]">Admin</span>
        </div>
    </nav>

    <script>
        // Database Sederhana (Local Storage)
        let users = JSON.parse(localStorage.getItem('quiz_users')) || {};
        let currentUser = null;
        let currentCorrectAnswer = null;

        // --- AUTH FUNCTIONS ---
        function toggleAuth(isLogin) {
            const title = document.getElementById('auth-title');
            const loginBtns = document.getElementById('login-buttons');
            const regBtns = document.getElementById('register-buttons');
            
            title.innerText = isLogin ? "Masuk" : "Daftar User";
            loginBtns.classList.toggle('hidden', !isLogin);
            regBtns.classList.toggle('hidden', isLogin);
        }

        function handleRegister() {
            const user = document.getElementById('username').value.trim();
            if (!user) return alert("Isi username!");
            
            if (users[user]) {
                alert("‚ùå Username '" + user + "' sudah digunakan. Pilih yang lain!");
            } else {
                users[user] = { points: 0 };
                saveData();
                alert("‚úÖ Pendaftaran Berhasil! Silakan Login.");
                toggleAuth(true);
            }
        }

        function handleLogin() {
            const user = document.getElementById('username').value.trim();
            if (users[user]) {
                currentUser = user;
                document.getElementById('auth-section').classList.add('hidden');
                document.getElementById('main-app').classList.remove('hidden');
                document.getElementById('display-user').innerText = currentUser;
                document.getElementById('display-points').innerText = users[currentUser].points;
                generateQuiz();
            } else {
                alert("‚ùå Akun tidak ditemukan!");
            }
        }

        function logout() {
            currentUser = null;
            location.reload();
        }

        // --- QUIZ LOGIC ---
        function generateQuiz() {
            const btnAds = document.getElementById('btn-ads');
            btnAds.disabled = true;
            btnAds.className = "w-full bg-gray-500 text-white py-4 rounded-xl font-bold cursor-not-allowed";
            
            const num1 = Math.floor(Math.random() * 100) + 1;
            const num2 = Math.floor(Math.random() * 100) + 1;
            currentCorrectAnswer = num1 + num2;

            document.getElementById('question').innerText = `${num1} + ${num2}`;
            
            // Buat pilihan jawaban (1 benar, 3 salah)
            let options = [currentCorrectAnswer];
            while(options.length < 4) {
                let wrong = currentCorrectAnswer + (Math.floor(Math.random() * 20) - 10);
                if (!options.includes(wrong) && wrong > 0) options.push(wrong);
            }
            
            // Acak posisi
            options.sort(() => Math.random() - 0.5);

            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';
            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.innerText = opt;
                btn.className = "bg-white/20 hover:bg-yellow-400 hover:text-purple-900 p-4 rounded-xl font-bold transition duration-300 animate__animated animate__zoomIn";
                btn.onclick = () => checkAnswer(opt);
                optionsContainer.appendChild(btn);
            });
        }

        function checkAnswer(selected) {
            const notif = document.getElementById('notif');
            notif.classList.remove('hidden', 'animate__fadeOutUp', 'animate__fadeInDown', 'bg-green-500', 'bg-red-500');
            
            if (selected === currentCorrectAnswer) {
                notif.innerText = "üéâ Benar! Klik Iklan untuk Poin.";
                notif.classList.add('bg-green-500', 'animate__fadeInDown');
                
                // Aktifkan Tombol Iklan
                const btnAds = document.getElementById('btn-ads');
                btnAds.disabled = false;
                btnAds.className = "w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-purple-900 py-4 rounded-xl font-bold shadow-lg animate__animated animate__pulse animate__infinite cursor-pointer";
            } else {
                notif.innerText = "‚ùå Salah! Coba lagi.";
                notif.classList.add('bg-red-500', 'animate__fadeInDown');
            }

            setTimeout(() => {
                notif.classList.add('animate__fadeOutUp');
            }, 2000);
        }

        // --- MONETAG INTEGRATION ---
        function showMonetagAd() {
            // Memanggil SDK Monetag
            show_9865183().then(() => {
                // Eksekusi setelah iklan selesai ditonton
                users[currentUser].points += 5;
                saveData();
                document.getElementById('display-points').innerText = users[currentUser].points;
                
                // Disable kembali tombol setelah klik
                const btnAds = document.getElementById('btn-ads');
                btnAds.disabled = true;
                btnAds.className = "w-full bg-gray-500 text-white py-4 rounded-xl font-bold cursor-not-allowed";
                
                alert('Selamat! Anda mendapatkan 5 poin.');
                generateQuiz(); // Reset soal setelah dapat poin
            }).catch((e) => {
                alert("Gagal memuat iklan. Pastikan Adblock mati.");
            });
        }

        function saveData() {
            localStorage.setItem('quiz_users', JSON.stringify(users));
        }
    </script>
</body>
</html>
